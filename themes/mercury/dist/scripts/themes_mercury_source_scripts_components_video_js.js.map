{"version":3,"file":"themes_mercury_source_scripts_components_video_js.js","mappings":";;;;;;;;;;;;;;;;;;;AAAO,IAAMA,KAAK;EAEd;AACJ;AACA;AACA;AACA;AACA;EACI,SAAAA,MAAYC,OAAO,EAAE;IAAAC,eAAA,OAAAF,KAAA;IAEjB,IAAI,CAACG,KAAK,GAAGF,OAAO;IACpB,IAAI,CAACG,MAAM,GAAGC,SAAS;IACvB,IAAI,CAACC,QAAQ,GAAG,IAAI,CAACH,KAAK,CAACI,OAAO,CAACC,OAAO;IAC1C,IAAI,CAACC,YAAY,GAAG,IAAI,CAACN,KAAK,CAACI,OAAO,CAACG,WAAW;IAClDC,MAAM,CAACC,cAAc,GAAGD,MAAM,CAACC,cAAc,IAAI,EAAE;IACnD,IAAI,CAACC,UAAU,GAAI,IAAI,CAACJ,YAAY,KAAK,SAAS,GAAI,oCAAoC,GAAG,wCAAwC;IACrI,IAAI,CAACK,aAAa,GAAG,IAAI,CAACX,KAAK,CAACI,OAAO,CAACQ,EAAE;;IAE1C;IACA,IAAI,CAACC,IAAI,CAAC,CAAC;EACf;;EAGA;AACJ;AACA;AACA;AACA;EAJIC,YAAA,CAAAjB,KAAA;IAAAkB,GAAA;IAAAC,KAAA,EAKA,SAAAH,KAAA,EAAO;MAEH;MACA,IAAI,CAACI,WAAW,CAAC,CAAC;;MAElB;MACA,IAAI,CAACC,iBAAiB,CAAC,CAAC;IAE5B;;IAGA;AACJ;AACA;AACA;AACA;EAJI;IAAAH,GAAA;IAAAC,KAAA,EAKA,SAAAE,kBAAA,EAAoB;MAAA,IAAAC,KAAA;MAChB,IAAI,CAACnB,KAAK,CAACoB,gBAAgB,CAAC,OAAO,EAAE;QAAA,OAAMD,KAAI,CAACE,MAAM,CAAC,CAAC;MAAA,EAAC;IAC7D;;IAGA;AACJ;AACA;AACA;AACA;EAJI;IAAAN,GAAA;IAAAC,KAAA,EAKA,SAAAC,YAAA,EAAc;MAEV;MACA,IAAIT,MAAM,CAACC,cAAc,CAACa,QAAQ,CAAC,IAAI,CAACZ,UAAU,CAAC,EAAE;;MAErD;MACAF,MAAM,CAACC,cAAc,CAACc,IAAI,CAAC,IAAI,CAACb,UAAU,CAAC;;MAE3C;MACA,IAAIc,MAAM,GAAGC,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC;;MAE7C;MACAF,MAAM,CAACG,GAAG,GAAG,IAAI,CAACjB,UAAU;;MAE5B;MACAe,QAAQ,CAACG,IAAI,CAACC,WAAW,CAACL,MAAM,CAAC;IAErC;;IAGA;AACJ;AACA;AACA;AACA;EAJI;IAAAT,GAAA;IAAAC,KAAA,EAKA,SAAAc,cAAA,EAAgB;MAEZ;MACA,IAAI,CAACC,IAAI,CAAC,CAAC;;MAEX;MACA,IAAI,CAAC9B,MAAM,CAAC+B,SAAS,CAAC,CAAC;IAE3B;;IAGA;AACJ;AACA;AACA;AACA;AACA;EALI;IAAAjB,GAAA;IAAAC,KAAA,EAMA,SAAAiB,oBAAoBC,KAAK,EAAE;MACvB,IAAIA,KAAK,CAACC,IAAI,IAAIC,EAAE,CAACC,WAAW,CAACC,KAAK,EAAE;QAEpC;QACA,IAAI,CAACrC,MAAM,CAACsC,MAAM,CAAC,CAAC,CAAC;;QAErB;QACA,IAAI,CAACtC,MAAM,CAACuC,UAAU,CAAC,CAAC;;QAExB;QACA,IAAI,CAACC,IAAI,CAAC,CAAC;MACf;IACJ;;IAGA;AACJ;AACA;AACA;AACA;EAJI;IAAA1B,GAAA;IAAAC,KAAA,EAKA,SAAAK,OAAA,EAAS;MAAA,IAAAqB,MAAA;MAEL;MACA,IAAI,IAAI,CAACzC,MAAM,EAAE;QACb,IAAI,CAAC0C,IAAI,CAAC,CAAC;MACf;MACA;MAAA,KACK;QAED;QACA,IAAI,IAAI,CAACrC,YAAY,KAAK,SAAS,EAAE;UACjC,IAAI,CAACL,MAAM,GAAG,IAAImC,EAAE,CAACQ,MAAM,CAAC,IAAI,CAACjC,aAAa,EAAE;YAC5CN,OAAO,EAAE,IAAI,CAACF,QAAQ;YACtB0C,MAAM,EAAE;cACJC,OAAO,EAAE,IAAI,CAAChB,aAAa,CAACiB,IAAI,CAAC,IAAI,CAAC;cACtCC,aAAa,EAAE,IAAI,CAACf,mBAAmB,CAACc,IAAI,CAAC,IAAI;YACrD;UACJ,CAAC,CAAC;QACN;;QAEA;QACA,IAAI,IAAI,CAACzC,YAAY,KAAK,OAAO,EAAE;UAC/B,IAAI,CAACL,MAAM,GAAG,IAAIgD,KAAK,CAACL,MAAM,CAAC,IAAI,CAACjC,aAAa,EAAE;YAC/CC,EAAE,EAAE,IAAI,CAACT,QAAQ;YACjB+C,SAAS,EAAE;UACf,CAAC,CAAC;;UAEF;UACA,IAAI,CAACjD,MAAM,CAACkD,EAAE,CAAC,MAAM,EAAE;YAAA,OAAMT,MAAI,CAACX,IAAI,CAAC,CAAC;UAAA,EAAC;UACzC,IAAI,CAAC9B,MAAM,CAACkD,EAAE,CAAC,OAAO,EAAE;YAAA,OAAMT,MAAI,CAACD,IAAI,CAAC,CAAC;UAAA,EAAC;;UAE1C;UACA,IAAI,CAACV,IAAI,CAAC,CAAC;;UAEX;UACA,IAAI,CAACY,IAAI,CAAC,CAAC;QACf;MACJ;IACJ;;IAEA;AACJ;AACA;AACA;AACA;EAJI;IAAA5B,GAAA;IAAAC,KAAA,EAKA,SAAA2B,KAAA,EAAO;MACF,IAAI,CAACrC,YAAY,KAAK,SAAS,GAAI,IAAI,CAACL,MAAM,CAAC+B,SAAS,CAAC,CAAC,GAAG,IAAI,CAAC/B,MAAM,CAAC0C,IAAI,CAAC,CAAC;IACpF;;IAGA;AACJ;AACA;AACA;AACA;EAJI;IAAA5B,GAAA;IAAAC,KAAA,EAKA,SAAAe,KAAA,EAAO;MACH,IAAI,CAAC/B,KAAK,CAACoD,SAAS,CAACC,GAAG,CAAC,SAAS,CAAC;IACvC;;IAGA;AACJ;AACA;AACA;AACA;EAJI;IAAAtC,GAAA;IAAAC,KAAA,EAKA,SAAAyB,KAAA,EAAO;MACH,IAAI,CAACzC,KAAK,CAACoD,SAAS,CAACE,MAAM,CAAC,SAAS,CAAC;IAC1C;EAAC;EAAA,OAAAzD,KAAA;AAAA","sources":["webpack://mercury/./themes/mercury/source/scripts/components/video.js"],"sourcesContent":["export class Video {\n\n    /**\n     * \n     * Constructor\n     * \n     * @param {element} element video parent\n     */\n    constructor(element) {\n\n        this.video = element;\n        this.player = undefined;\n        this.video_id = this.video.dataset.videoId;\n        this.video_source = this.video.dataset.videoSource;\n        window.loaded_scripts = window.loaded_scripts || [];\n        this.script_src = (this.video_source === 'youtube') ? 'https://www.youtube.com/iframe_api' : 'https://player.vimeo.com/api/player.js';\n        this.video_element = this.video.dataset.id;\n\n        // Initialise the video\n        this.init();\n    }\n\n\n    /**\n     * \n     * Initialise the video item\n     * \n     */\n    init() {\n\n        // Load the scripts\n        this.loadScripts();\n\n        // Attach the event listeners\n        this.addEventListeners();\n\n    }\n\n\n    /**\n     * \n     * Add the click event handler to the video\n     * \n     */\n    addEventListeners() {\n        this.video.addEventListener('click', () => this.create());\n    }\n\n\n    /**\n     * \n     * Load the scripts if they have not already been loaded\n     * \n     */\n    loadScripts() {\n\n        // If the script has already been loaded, return\n        if (window.loaded_scripts.includes(this.script_src)) return;\n\n        // Add the script to the loaded scripts array\n        window.loaded_scripts.push(this.script_src);\n\n        // Create the script tag\n        let script = document.createElement('script');\n\n        // Set the script source\n        script.src = this.script_src;\n\n        // Append the script to the body\n        document.body.appendChild(script);\n\n    }\n\n\n    /**\n     * \n     * Youtube on player ready event handler\n     * \n     */\n    onPlayerReady() {\n\n        // Show the video and hide the thumbnail\n        this.show();\n\n        // Play the youtube video\n        this.player.playVideo();\n\n    }\n\n\n    /**\n     * \n     * Youytube Player play state event handler\n     * \n     * @param {event} event\n     */\n    onPlayerStateChange(event) {\n        if (event.data == YT.PlayerState.ENDED) {\n\n            // Reset the video to the start\n            this.player.seekTo(0)\n\n            // Pause the video\n            this.player.pauseVideo();\n\n            // Hide the video and show the thumbnail\n            this.hide();\n        }\n    }\n\n\n    /**\n     * \n     * Create the video player instance\n     * \n     */\n    create() {\n\n        // If the pkayer has already been created, then just hit play\n        if (this.player) {\n            this.play();\n        }\n        // Otherwise we will need to create the player first\n        else {\n\n            // Youtube specific video createion\n            if (this.video_source === 'youtube') {\n                this.player = new YT.Player(this.video_element, {\n                    videoId: this.video_id,\n                    events: {\n                        onReady: this.onPlayerReady.bind(this),\n                        onStateChange: this.onPlayerStateChange.bind(this)\n                    }\n                });\n            }\n\n            // Vimeo specific video creation\n            if (this.video_source === 'vimeo') {\n                this.player = new Vimeo.Player(this.video_element, {\n                    id: this.video_id,\n                    autopause: false\n                });\n\n                // Attach the event listeners\n                this.player.on('play', () => this.show());\n                this.player.on('ended', () => this.hide());\n\n                // Show the video and hide the thumbnail\n                this.show();\n\n                // Play the vimeo video\n                this.play();\n            }\n        }\n    }\n\n    /**\n     * \n     * Play the video instance\n     * \n     */\n    play() {\n        (this.video_source === 'youtube') ? this.player.playVideo() : this.player.play();\n    }\n\n\n    /**\n     * \n     * Show the video and hide the thumbnail\n     * \n     */\n    show() {\n        this.video.classList.add('playing');\n    }\n\n\n    /**\n     * \n     * Hide the video and show the thumbnail\n     * \n     */\n    hide() {\n        this.video.classList.remove('playing');\n    }\n\n\n}\n\n"],"names":["Video","element","_classCallCheck","video","player","undefined","video_id","dataset","videoId","video_source","videoSource","window","loaded_scripts","script_src","video_element","id","init","_createClass","key","value","loadScripts","addEventListeners","_this","addEventListener","create","includes","push","script","document","createElement","src","body","appendChild","onPlayerReady","show","playVideo","onPlayerStateChange","event","data","YT","PlayerState","ENDED","seekTo","pauseVideo","hide","_this2","play","Player","events","onReady","bind","onStateChange","Vimeo","autopause","on","classList","add","remove"],"sourceRoot":""}